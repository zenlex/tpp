<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="style.css" rel="stylesheet">
  <title>Turtle Graphics</title>
</head>

<body>
  <header>
    <h1>Turtle Graphics Engine</h1>
    <h4>an exercise in extensible domain specific languages</h4>
  </header>
  <main>
    <div class='flexbox'>
      <form id="prog-form">
        <textarea cols=10 rows=20 id="user-prog" name="prog"></textarea>
        <div class='btn-cont'>
          <button type="submit">Run Program</button>
          <button type="button" id="clear-btn">Clear Canvas</button>
        </div>
      </form>
      <div id='com-cont'>
        <h2>commands</h2>
        <div id='comlist'></div>
        <div id='comnotes'>
          <h4>
            Syntax:
          </h4>
          <ul>
            <li>
              <p>
                'COM'<i>(space)[int]</i>
              </p>
                
            </li>
          </ul>
        </div>
      </div>
      <canvas id="turtle-canvas"></canvas>
    </div>
  </main>
</body>
<script type='module'>
  import Turtle from './turtle.js'

  const canvas = document.getElementById('turtle-canvas')
  const turtle = new Turtle(canvas)

  function runTurtle(e) {
    e.preventDefault()
    const prog = e.target.prog.value
    turtle.run(prog)
  }

  function resizeView(canvas) {
    let cw = window.innerWidth * (2 / 3);
    let ch = window.innerHeight * .8;
    turtle.resizeCanvas(canvas, cw, ch);
  };

  resizeView(canvas);

  document.querySelector('#prog-form').onsubmit = runTurtle
  document.querySelector('#clear-btn').onclick = turtle.clearCanvas
  window.onresize = () => resizeView(canvas)
  const comlist = document
    .querySelector('#comlist')
    .appendChild(document.createElement('ul'));

  turtle.commands.forEach((item) => {
    const newItem = comlist.appendChild(document.createElement('li'))
    newItem.innerHTML = `<span>${item.name} ${item.arg ? '#' : ''} - ${item.desc}</span>`
  })
</script>

</html>